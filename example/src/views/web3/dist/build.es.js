import n from"web3";import t from"@metamask/detect-provider";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(n,t,e,i){return new(e||(e=Promise))((function(r,o){function s(n){try{a(i.next(n))}catch(n){o(n)}}function c(n){try{a(i.throw(n))}catch(n){o(n)}}function a(n){n.done?r(n.value):new e((function(t){t(n.value)})).then(s,c)}a((i=i.apply(n,t||[])).next())}))}let i=null;class r{constructor(n){this.code=n.code,this.data=n.data,this.message=n.message}}class o{constructor(n,t,e){this.code=n,this.message=t,this.data=e}}const s={SUCCESS:n=>new o(0,"success",n),DEFAULT_STATE:n=>new o(1,"default state",n),ERROR_STATE:n=>new o(4,"error state",n),NOT_SUPPORT:n=>new o(5,"The method is not supported",n)};class c{getAccount(){return e(this,void 0,void 0,(function*(){try{let n=yield window.web3.eth.getAccounts();return new r(s.SUCCESS(n))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class a{getBalance(n){return e(this,void 0,void 0,(function*(){try{let t=yield window.web3.eth.getBalance(n);return new r(s.SUCCESS(t))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class l{}class u{getBlock(n){return e(this,void 0,void 0,(function*(){try{let t=yield window.web3.eth.getBlock(n),e=new l;return e.number=t.number,e.hash=t.hash,e.parentHash=t.parentHash,e.nonce=t.nonce,e.sha3Uncles=t.sha3Uncles,e.logsBloom=t.logsBloom,e.transactionsRoot=t.transactionsRoot,e.stateRoot=t.stateRoot,e.miner=t.miner,e.difficulty=t.difficulty,e.totalDifficulty=t.totalDifficulty,e.size=t.size,e.extraData=t.extraData,e.gasLimit=t.gasLimit,e.gasUsed=t.gasUsed,e.timestamp=t.timestamp,e.transactions=t.transactions,e.uncles=t.uncles,new r(s.SUCCESS(e))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class d{getBlockNumber(){return e(this,void 0,void 0,(function*(){try{let n=yield window.web3.eth.getBlockNumber();return new r(s.SUCCESS(n))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class w{}class h{getTransaction(n){return e(this,void 0,void 0,(function*(){try{let t=yield window.web3.eth.getTransaction(n),e=new w;return t?(e.hash=t.hash,e.nonce=t.nonce,e.blockHash=t.blockHash,e.blockNumber=t.blockNumber,e.transactionIndex=t.transactionIndex,e.from=t.from,e.to=t.to,e.value=t.value,e.gas=t.gas,e.gasPrice=t.gasPrice,e.input=t.input,new r(s.SUCCESS(e))):new r(s.ERROR_STATE(null))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class S{getTransactionCount(n){return e(this,void 0,void 0,(function*(){try{let t=yield window.web3.eth.getTransactionCount(n);return new r(s.SUCCESS(t))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class g{sendSignedTransaction(n){return e(this,void 0,void 0,(function*(){try{let t=yield window.web3.eth.sendSignedTransaction(n);return new r(s.SUCCESS(t))}catch(n){return new r(s.DEFAULT_STATE(null))}}))}}class v{signWithPrivateKey(n,t){return e(this,void 0,void 0,(function*(){try{let e=yield window.web3.eth.accounts.sign(n,t);return new r(s.SUCCESS(e))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class T{signWithWallet(n,t){return e(this,void 0,void 0,(function*(){try{let e=yield window.web3.utils.utf8ToHex(n),i=yield window.web3.eth.personal.sign(e,t);return new r(s.SUCCESS(i))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class f{signTransaction(n,t){return e(this,void 0,void 0,(function*(){return new r(s.NOT_SUPPORT(null))}))}}class y{signTransactionPrivateKey(n,t){return e(this,void 0,void 0,(function*(){try{let e=yield window.web3.eth.accounts.signTransaction(n,t);return new r(s.SUCCESS(e))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class E{sendTransaction(n){return e(this,void 0,void 0,(function*(){try{return yield window.web3.eth.sendTransaction(n).then(n=>new r(s.SUCCESS(n)))}catch(n){return new r(s.DEFAULT_STATE(null))}}))}}class R{loadContract(n,t){return e(this,void 0,void 0,(function*(){try{let e=yield new window.web3.eth.Contract(n,t);return new r(s.SUCCESS(e))}catch(n){return new r(s.ERROR_STATE(null))}}))}}class C{constructor(){}getAccount(){return e(this,void 0,void 0,(function*(){return yield(new c).getAccount()}))}getBalance(n){return e(this,void 0,void 0,(function*(){return yield(new a).getBalance(n)}))}getBlock(n){return e(this,void 0,void 0,(function*(){return yield(new u).getBlock(n)}))}getBlockNumber(){return e(this,void 0,void 0,(function*(){return yield(new d).getBlockNumber()}))}getTransaction(n){return e(this,void 0,void 0,(function*(){return yield(new h).getTransaction(n)}))}getTransactionCount(n){return e(this,void 0,void 0,(function*(){return yield(new S).getTransactionCount(n)}))}sendSignedTransaction(n){return e(this,void 0,void 0,(function*(){return yield(new g).sendSignedTransaction(n)}))}signWithWallet(n,t){return e(this,void 0,void 0,(function*(){return yield(new T).signWithWallet(n,t)}))}signWithPrivateKey(n,t){return e(this,void 0,void 0,(function*(){return yield(new v).signWithPrivateKey(n,t)}))}signTransaction(n,t){return e(this,void 0,void 0,(function*(){return yield(new f).signTransaction(n,t)}))}signTransactionPrivateKey(n,t){return e(this,void 0,void 0,(function*(){return yield(new y).signTransactionPrivateKey(n,t)}))}sendTransaction(n){return e(this,void 0,void 0,(function*(){return yield(new E).sendTransaction(n)}))}loadContract(n,t){return e(this,void 0,void 0,(function*(){return yield(new R).loadContract(n,t)}))}}class m{link(){if(window.ethereum.enable){let n=window.ethereum.selectedAddress;return n?new r(s.SUCCESS(n)):window.ethereum.enable().then(n=>new r(s.SUCCESS(n[0])))}return new r(s.ERROR_STATE("Please go and install"))}}const b="4000000000",A="150000";let U=function(n,t,e){let i;console.log(t),i=new r(e?s.ERROR_STATE(null):s.SUCCESS(t)),n(i)};function O(n,t,e){let i;try{i=n.methods[t]}catch(n){i=null}return i?{prop:i(...e)._method,func:i}:null}class _{offChainCall(n,t,i,o,c){return e(this,void 0,void 0,(function*(){let o=0!==Object.keys(window.web3).length?yield window.web3.eth.getAccounts():[""],c=O(n,t,i);return c?yield new Promise(n=>e(this,void 0,void 0,(function*(){c.func(...i).call({from:o[0],gas:"100000000"},(t,e)=>{U(n,e,t)}).catch(t=>{console.log(2),U(n,t,null)})}))):new r(s.ERROR_STATE("参数有误"))}))}onChainCall(n,t,i,o){return e(this,void 0,void 0,(function*(){let e=0!==Object.keys(window.web3).length?yield window.web3.eth.getAccounts():[""];console.log(e);let c=O(n,t,i);if(!c)return new r(s.ERROR_STATE("参数有误"));let a=((l=o).gasPrice=l.gasPrice?l.gasPrice:b,l.gasLimit=l.gasLimit?l.gasLimit:A,l);var l;let u={from:e[0],gasPrice:a.gasPrice,gas:a.gasLimit};return yield new Promise(n=>{c.func(...i).send(u,(n,t)=>{}).then(t=>{U(n,t,null)}).catch(t=>{U(n,t,null)})})}))}}class P{constructor(){this.actions=new C,this.connector=new m,this.contract=new _}init(){return e(this,void 0,void 0,(function*(){return window.web3=yield async function(){return i=await t(),i?new n(i):null}(),new r(s.SUCCESS(null))}))}}export{P as Actions,s as PredefinedStatus};
//# sourceMappingURL=build.es.js.map
